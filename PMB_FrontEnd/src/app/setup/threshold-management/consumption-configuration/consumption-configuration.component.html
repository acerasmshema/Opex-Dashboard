<div class="container-fluid" style="padding: 0">
  <p-tabView>
    <p-tabPanel header="Consumption Configuration" leftIcon="fa fa-sun-o" selected="true">
      <ng-template pTemplate="consumption-configuration">
        <div class="dashboard-container" style="height: 83.7vh;">
          <div class="row m-t-10" style="background: #efefef">
            <div class="col-md-2"></div>
            <div class="col-md-3">
              <div class="form-inline">
                <label class="m-r-5">Business Type</label>
                <select class="form-control setup-select col-8" (change)="onBuTypeChange($event.target.value)">
                  <option disabled value="" selected>Select Business Type</option>
                  <option *ngFor="let buType of consumptionConfig.buTypes" [value]="buType.buTypeId">
                    {{buType.buTypeName}}</option>
                </select>
              </div>
            </div>
            <div class="col-md-3" style="margin-right: -30px;">
              <div class="form-inline">
                <label class="m-r-5">Kpi Category</label>
                <select class="form-control setup-select col-8" (change)="onKpiCategoryChange($event.target.value)">
                  <option disabled value="" selected>Select Category</option>
                  <option *ngFor="let kpiCategory of consumptionConfig.kpiCategories" [value]="kpiCategory.kpiCategoryId">
                    {{kpiCategory.kpiCategoryName}}</option>
                </select>
              </div>
            </div>
            <div class="col-md-3" style="margin-right: -30px;">
              <div class="form-inline">
                <label>KPI</label>
                <select class="form-control setup-select col-9" (change)="onKPIChange($event.target.value)">
                  <option selected value="" disabled>Select KPI</option>
                  <option *ngFor="let kpi of consumptionConfig.kpis" [value]="kpi.kpiId">{{kpi.kpiName}} ({{kpi.unit}})
                  </option>
                </select>
              </div>
            </div>
            <div class="col-md-1">
              <span (click)="onSearch()">
                <em class="fa fa-search fa-2x" pTooltip="Search" tooltipPosition="top"></em>
              </span>
            </div>
          </div>
          <div *ngIf="consumptionThresholds.length  > 0" class="m-t-10">
            <p-table #consumption [columns]="cols" [value]="consumptionThresholds" [paginator]="true" [rows]="8"
              dataKey="consumptionThresholdId" [resizableColumns]="true" [reorderableColumns]="true"
              [scrollable]="false" sortField="buType" sortOrder="1">
              <ng-template pTemplate="caption">
                <div class="text-right">
                  <span class="m-l-5" (click)="onCreate()">
                    <em class="fa fa-plus fa-2x" pTooltip="Add Consumption Threshold" tooltipPosition="top"></em>
                  </span>
                </div>
              </ng-template>
              <ng-template pTemplate="header" let-columns>
                <tr>
                  <th class="text-center" style="width: 4%;"></th>
                  <th class="text-center" *ngFor="let col of columns" [pSortableColumn]="col.field" pResizableColumn
                    pReorderableColumn [style.width]="col.width">
                    <p-sortIcon [field]="col.field" pTooltip="Sort" tooltipPosition="top"></p-sortIcon>
                    {{col.header}}
                  </th>
                  <th class="text-center" style="width: 10%">Action</th>
                </tr>
                <tr class="text-center">
                  <th style="width: 4%;"><i class="fa fa-search"></i></th>
                  <th *ngFor="let col of columns" [ngSwitch]="col.field" class="ui-fluid">
                    <input *ngIf="col.showInputBox" pInputText type="text"
                      (input)="consumption.filter($event.target.value, col.field, col.filterMatchMode)"
                      [value]="consumption.filters[col.field]?.value">
                  </th>
                  <th></th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-rowData let-ri="rowIndex" let-columns="columns">
                <tr [pSelectableRow]="rowData">
                  <td class="td-role text-center">{{ri + 1}}</td>
                  <td *ngFor="let col of columns" class="text-center">
                    <div *ngIf="col.field === 'processLine'" class="td-role">{{rowData[col.field].processLineCode}}
                    </div>
                    <div *ngIf="col.field !== 'processLine'" class="td-role">{{rowData[col.field]}}</div>
                  </td>
                  <td class="text-center">
                    <span class="font-17" style="color: #3e3e3e;" (click)="onEdit(rowData.consumptionThresholdId)"><i
                        class="fa fa-edit" pTooltip="Edit" tooltipPosition="top"></i></span>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </ng-template>
    </p-tabPanel>
  </p-tabView>
</div>